# Get unique keys and their min and max values for a table
def get_unique_keys_info(table, schema):
    key_columns_query = f"""
    SELECT a.attname AS column_name
    FROM pg_index i
    JOIN pg_attribute a ON a.attnum = ANY(i.indkey)
    JOIN pg_class c ON c.oid = i.indrelid
    JOIN pg_namespace n ON n.oid = c.relnamespace
    WHERE i.indisunique
      AND c.relname = '{table}'
      AND n.nspname = '{schema}';
    """
    with get_connection() as conn:
        key_columns = pd.read_sql(key_columns_query, conn)['column_name']

    keys_info = []
    for column in key_columns:
        min_max_query = f"""
        SELECT 
            '{column}' AS column_name,
            MIN({column}) AS min_value,
            MAX({column}) AS max_value
        FROM {schema}.{table};
        """
        with get_connection() as conn:
            result = pd.read_sql(min_max_query, conn)
            keys_info.append(result)

    return pd.concat(keys_info, ignore_index=True) if keys_info else pd.DataFrame()
