import csv
import sqlite3

# Define your database file name
db_name = 'mydatabase.db'

# Define your table name and columns here. Adjust as per your data.
table_name = 'my_table'
columns = 'col1 TEXT, col2 TEXT, col3 INTEGER'  # Example column definitions

# Connect to SQLite database
conn = sqlite3.connect(db_name)
cursor = conn.cursor()

# Create table
cursor.execute(f'CREATE TABLE IF NOT EXISTS {table_name} ({columns})')
conn.commit()

# Function to insert data into table
def insert_data(row):
    placeholders = ', '.join(['?'] * len(row))
    sql = f'INSERT INTO {table_name} VALUES ({placeholders})'
    cursor.execute(sql, row)

# Read the pipe-separated file and insert data
try:
    with open('yourfile.psv', 'r') as file:
        reader = csv.reader(file, delimiter='|')
        for row in reader:
            insert_data(row)
    conn.commit()
except Exception as e:
    print(f'Error: {e}')
finally:
    conn.close()

print('Data loaded successfully')
