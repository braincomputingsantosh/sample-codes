WITH table_modification_times AS (
    SELECT 
        schemaname,
        relname AS table_name,
        pg_stat_get_last_vacuum_time(c.oid) AS last_vacuum_time,
        pg_stat_get_last_analyze_time(c.oid) AS last_analyze_time,
        pg_stat_get_last_auto_vacuum_time(c.oid) AS last_auto_vacuum_time,
        pg_stat_get_last_auto_analyze_time(c.oid) AS last_auto_analyze_time,
        greatest(
            pg_stat_get_last_vacuum_time(c.oid),
            pg_stat_get_last_analyze_time(c.oid),
            pg_stat_get_last_auto_vacuum_time(c.oid),
            pg_stat_get_last_auto_analyze_time(c.oid)
        ) AS last_modification_time
    FROM 
        pg_class c
    JOIN 
        pg_namespace n ON n.oid = c.relnamespace
    WHERE 
        c.relkind = 'r' 
        AND n.nspname = 'your_schema_name' -- Replace with your schema name
)
SELECT 
    schemaname,
    max(last_modification_time) AS last_modification_time
FROM 
    table_modification_times
GROUP BY 
    schemaname;
