WITH geo AS (
  SELECT geoid, tract, county, state AS st_num, stusab AS state,
         logrecno, year, sumlevel
  FROM census.geo_sf_2010
  WHERE sumlevel = 140
),
sf AS (
  SELECT *
  FROM census.sf1
  WHERE tbl IN ('p1-0')
)
SELECT a.stat, a.logrecno, a.year, a.tbl, b.state, b.county, b.tract,
       b.st_num, b.sumlevel
FROM sf a
INNER JOIN geo b
  ON a.state = b.state
  AND a.logrecno = b.logrecno
  AND a.year = b.year;
