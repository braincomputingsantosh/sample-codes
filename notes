CREATE OR REPLACE PROCEDURE update_gpra_calculated_date()
LANGUAGE plpgsql
AS $$
BEGIN
    -- Update the gpra_calculated_date column in the exams table
    UPDATE exams
    SET gpra_calculated_date = calculate_gpra_date(exam_analysis_finalized, draft_to_prudential);

    -- Commit the transaction
    COMMIT;

    -- Output the number of rows updated
    RAISE NOTICE 'Updated % rows in the exams table', ROW_COUNT();
END;
$$;
