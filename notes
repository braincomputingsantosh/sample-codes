-- Begin a transaction
BEGIN;

-- Update the tbl column
UPDATE census.sf1_temp
SET tbl = SPLIT_PART(tbl, '_', 1)
WHERE tbl LIKE '%_%';

-- Check how many rows were updated
SELECT 'Rows updated: ' || COUNT(*) AS update_count
FROM census.sf1_temp
WHERE tbl NOT LIKE '%_%';

-- Commit the transaction
COMMIT;
