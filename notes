import requests
import json

# Define your Databricks workspace URL and personal access token
DATABRICKS_INSTANCE = 'https://<your-databricks-instance>'
ACCESS_TOKEN = 'dapi<your-access-token>'

# Define the headers for authentication
headers = {
    'Authorization': f'Bearer {ACCESS_TOKEN}',
    'Content-Type': 'application/json'
}

# Generic function to get details from Databricks API
def get_databricks_details(endpoint):
    response = requests.get(endpoint, headers=headers)
    if response.status_code == 200:
        return response.json()
    else:
        print(f'Error: {response.status_code}, {response.text}')
        return None

# Function to fetch and print details for a given data type endpoint
def fetch_and_print_details(data_type, endpoint_suffix):
    endpoint = f'{DATABRICKS_INSTANCE}/api/2.0/{endpoint_suffix}'
    details = get_databricks_details(endpoint)
    if details:
        print(f'Details for {data_type}:')
        print(json.dumps(details, indent=2))

# Example usage for AccessLevelFilter
fetch_and_print_details('AccessLevelFilter', 'preview/permissions/workspaces')
