WITH formatted_event_ids AS (
    SELECT 'EID-' || LPAD(unnest(string_to_array('11521,2521,5214,521', ',')), 8, '0') AS event_id
),
update_logic AS (
    SELECT 
        e.*,
        CASE
            WHEN e.Calendared IS NULL OR e.Calendared = '' THEN
                CASE
                    WHEN e.Event_ID = ANY (SELECT event_id FROM formatted_event_ids) THEN 'Yes'
                    ELSE 'No'
                END
            ELSE e.Calendared
        END AS proposed_est_calendared
    FROM public.exams e
)
SELECT * FROM update_logic;
