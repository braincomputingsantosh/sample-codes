WITH table_modification_times AS (
    SELECT 
        n.nspname AS schemaname,
        c.relname AS tablename,
        greatest(
            pg_xact_commit_timestamp(xmin),
            pg_xact_commit_timestamp(COALESCE(c.relfrozenxid, c.relfrozenxid))
        ) AS last_modification_time
    FROM 
        pg_class c
    JOIN 
        pg_namespace n ON n.oid = c.relnamespace
    WHERE 
        c.relkind = 'r' -- Only consider regular tables
        AND n.nspname = 'your_schema_name' -- Replace with your schema name
)
SELECT 
    schemaname,
    max(last_modification_time) AS last_modification_time
FROM 
    table_modification_times
GROUP BY 
    schemaname;
