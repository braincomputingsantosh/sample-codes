WITH event_ids AS (
    SELECT unnest(string_to_array('your_event_id_list_here', ',')) AS event_id
),
calculated_updates AS (
    SELECT
        e.*,
        CASE
            WHEN e.Calendared IS NULL OR e.Calendared = '' THEN
                CASE
                    WHEN e.Event_ID = ANY (SELECT event_id FROM event_ids) THEN 'Yes'
                    ELSE 'No'
                END
            ELSE e.Calendared
        END AS proposed_est_calendared
    FROM public.exams e
)
SELECT * FROM calculated_updates;
