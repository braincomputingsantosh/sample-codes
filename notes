CREATE OR REPLACE PROCEDURE update_est_calendared(event_id_list TEXT)
LANGUAGE plpgsql
AS $$
DECLARE
    event_ids TEXT[];
BEGIN
    -- Convert comma-separated list to array
    event_ids := string_to_array(event_id_list, ',');

    -- Update logic based on array of Event_IDs
    UPDATE events
    SET est_calendared = CASE
        WHEN Calendared IS NULL OR Calendared = '' THEN
            CASE
                WHEN Event_ID = ANY(event_ids) THEN 'Yes'
                ELSE 'No'
            END
        ELSE Calendared
    END;
END;
$$;
