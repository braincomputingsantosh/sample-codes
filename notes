import os
from databricks_cli.sdk.api_client import ApiClient
from databricks_cli.dbfs.api import DbfsApi

# Configure the API client
api_client = ApiClient(host="DATABRICKS_HOST", token="DATABRICKS_TOKEN")
dbfs_api = DbfsApi(api_client)

def copy_to_dbfs(local_dir, dbfs_dir):
    for root, dirs, files in os.walk(local_dir):
        for file in files:
            local_path = os.path.join(root, file)
            relative_path = os.path.relpath(local_path, local_dir)
            dbfs_path = os.path.join(dbfs_dir, relative_path)

            print(f"Copying {local_path} to {dbfs_path}")
            dbfs_api.cp(recursive=False, src=local_path, dst=dbfs_path, overwrite=True)

# Set your local directory and DBFS destination directory
local_directory = "/path/to/local/directory"
dbfs_directory = "dbfs:/path/to/dbfs/directory"

copy_to_dbfs(local_directory, dbfs_directory)
