WITH table_modification_times AS (
    SELECT
        schemaname,
        relname AS tablename,
        greatest(
            last_vacuum, 
            last_autovacuum, 
            last_analyze, 
            last_autoanalyze
        ) AS last_modification_time
    FROM
        pg_stat_all_tables
    WHERE
        schemaname = 'your_schema_name' -- Replace with your schema name
)
SELECT
    schemaname,
    max(last_modification_time) AS last_modification_time
FROM
    table_modification_times
GROUP BY
    schemaname;
