# Import necessary libraries
from pyspark.sql import SparkSession
import os

# Initialize Spark session
spark = SparkSession.builder.appName("ListFiles").getOrCreate()

# Define the folder path
folder_path = "/path/to/your/folder"

# Function to get file name without extension
def get_filename_without_extension(file_path):
    return os.path.splitext(os.path.basename(file_path))[0]

# List files in the folder and create key-value pairs
file_list = dbutils.fs.ls(folder_path)
key_value_pairs = {file_info.path: get_filename_without_extension(file_info.path) for file_info in file_list}

# Display the key-value pairs
for key, value in key_value_pairs.items():
    print(f"Key: {key}, Value: {value}")

# Stop the Spark session
spark.stop()
