import pandas as pd
import re

# Adjust this to the path of your CSV file
file_path = 'path_to_your_file.csv'

# Load the CSV file
df = pd.read_csv(file_path)

# Inspect the first few rows of the action_origin column
print("First few rows of 'action_origin':")
print(df['action_origin'].head())

# Check for HTML tags in the action_origin column
# This pattern looks for strings that start with '<' and end with '>', indicative of HTML
pattern = re.compile(r'<[^>]+>')

# Create a column that flags rows with HTML in action_origin
df['has_html_action_origin'] = df['action_origin'].apply(lambda x: bool(pattern.search(str(x))))

# Check if there's any row with HTML
if df['has_html_action_origin'].any():
    print("\nHTML tags found in 'action_origin' column. Here are examples:")
    print(df[df['has_html_action_origin']]['action_origin'].head())
else:
    print("\nNo HTML tags found in 'action_origin' column.")

# Optionally, check for HTML tags in other columns as well
for column in df.columns:
    df[f'has_html_{column}'] = df[column].apply(lambda x: bool(pattern.search(str(x))))
    if df[f'has_html_{column}'].any():
        print(f"\nHTML tags found in '{column}' column. Here are examples:")
        print(df[df[f'has_html_{column}']]['action_origin'].head())
