import psycopg2

# Replace these variables with your actual database connection details
DB_NAME = "your_dbname"
USER = "your_username"
PASSWORD = "your_password"
HOST = "localhost"
PORT = "5432"

# Specify the state you want to filter by
state_to_copy = 'YourStateName'  # Replace 'YourStateName' with your specific state name

try:
    # Connect to your database
    conn = psycopg2.connect(dbname=DB_NAME, user=USER, password=PASSWORD, host=HOST, port=PORT)
    
    # Create a cursor object
    cur = conn.cursor()
    
    # SQL query to copy rows from census.sf2 to census.sf1 for a specific state
    copy_query = f"""
    INSERT INTO census.sf1 (column1, column2, column3, ...)  -- replace these columns with your actual column names
    SELECT column1, column2, column3, ...  -- same here
    FROM census.sf2
    WHERE state = '{state_to_copy}'
    LIMIT 10000;
    """
    
    # Execute the query
    cur.execute(copy_query)
    
    # Commit the transaction
    conn.commit()
    
    print("Rows successfully copied.")
except Exception as e:
    print("An error occurred:", e)
finally:
    # Close the cursor and connection
    cur.close()
    conn.close()
