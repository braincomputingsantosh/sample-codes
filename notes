import pandas as pd

def generate_insert_statements(file_path, table_name):
    # Read the file into a DataFrame
    df = pd.read_csv(file_path, sep='|')

    # Start building the INSERT statements
    insert_statements = []

    for _, row in df.iterrows():
        # Prepare the values for insertion (handle strings and NULLs appropriately)
        values = []
        for value in row:
            if pd.isna(value):
                values.append('NULL')
            elif isinstance(value, str):
                # Escape single quotes for SQL
                value = value.replace("'", "''")
                values.append(f"'{value}'")
            else:
                values.append(str(value))
        values_str = ', '.join(values)

        # Add the INSERT statement for this row
        insert_statements.append(f"INSERT INTO {table_name} VALUES ({values_str});")

    return '\n'.join(insert_statements)

# Example usage
file_path = 'path_to_your_data_file.txt'  # Replace with your file path
table_name = 'your_table_name'            # Replace with your table name

insert_statements = generate_insert_statements(file_path, table_name)
print(insert_statements)

# https://github.com/vengroff/censusdis/blob/main/notebooks/DHC-A.ipynb
