import sqlite3
import csv

# Connect to SQLite database (or create it if it doesn't exist)
conn = sqlite3.connect('VAsf1.db')
cursor = conn.cursor()

# Create the vasf1 table
cursor.execute('''
CREATE TABLE IF NOT EXISTS vasf1 (
    file_id INTEGER,
    year INTEGER,
    sftype TEXT,
    state TEXT,
    col1 INTEGER,
    segment INTEGER,
    logrecno INTEGER,
    tbl TEXT,
    stat DECIMAL
)
''')

# Open and read the SF1 file
with open('abc.sf1', 'r') as file:
    csv_reader = csv.reader(file)
    next(csv_reader)  # Skip the header row

    # Prepare the insert statement
    insert_query = '''
    INSERT INTO vasf1 (file_id, year, sftype, state, col1, segment, logrecno, tbl, stat)
    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
    '''

    # Process each row and insert into the database
    for row in csv_reader:
        sftype, state, _, col1, segment, logrecno = row
        file_id = 701701
        year = 2010
        tbl = None
        stat = None

        # Convert data types as needed
        col1 = int(col1)
        segment = int(segment)
        logrecno = int(logrecno)

        cursor.execute(insert_query, (file_id, year, sftype, state, col1, segment, logrecno, tbl, stat))

# Commit changes and close the connection
conn.commit()
conn.close()

print("Data ingestion complete.")
